{{>page_errors}}
<div id="page-messages">
{{#each pageMessages}}
<div class="message-box">{{{this}}}</div>
{{/each}}
</div>
<div class="centered-column">
<!-- permanent ID of this item: {{{thing.id}}} -->
<span itemscope itemtype="https://schema.org/Product">
<h1 id="page-header">
<span itemprop="name">{{{getThingLabel thing}}}</span>
{{#if thing.userCanEdit}}
<a href="/{{{thing.urlID}}}/edit/label" id="add-label" class="pure-button button-rounded edit-button"><span class="fa fa-fw fa-pencil spaced-icon">&nbsp;</span>
{{#if (mlString thing.label)}}{{{__ "edit"}}}{{else}}{{{__ "add label"}}}{{/if}}
</a>
{{/if}}
</h1>
{{#if thing.urls}}
<div id="item-url"><span class="fa fa-fw fa-external-link review-icon">&nbsp;</span>{{{link thing.urls.[0] (prettify thing.urls.[0])}}}</div>
{{/if}}
<div id="item-description">
{{#if (mlString thing.description)}}<span class="fa fa-fw fa-info-circle review-icon">&nbsp;</span>{{{mlString thing.description}}}{{/if}}{{#unless thing.sync.description.active}}{{#if thing.userCanEdit}}
<a href="/{{{thing.urlID}}}/edit/description" id="add-description" class="pure-button button-rounded edit-button"><span class="fa fa-fw fa-pencil spaced-icon">&nbsp;</span>
{{#if (mlString thing.description)}}{{{__ "edit"}}}{{else}}{{{__ "add description"}}}{{/if}}
{{/if}}
{{else}}
<span class="fa fa-refresh fa-fw sync-icon" title="{{{__ "synced info"}}}
{{{__ "sync source" (__ (getSourceMsgKey thing.sync.description.source))}}}
{{{__ "sync date" (longDate thing.sync.description.updated)}}}"></span>
{{/unless}}

</a></div>
{{#if thing.files}}
{{>uploads}}
{{/if}}
{{#if thing.userCanUpload}}
<p>
{{>upload_form}}
{{/if}}
{{#if hasMoreThanOneReview}}
<div class="review-metrics">
{{{__ "review metrics" (__n "one or multiple stars" (round thing.averageStarRating 1)) (__n "one or multiple reviews" thing.numberOfReviews)}}}
</div>
{{/if}}
<span itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
<meta itemprop="ratingValue" content="{{{round thing.averageStarRating 1}}}"/>
<meta itemprop="ratingCount" content="{{{thing.numberOfReviews}}}"/>
</span>
</span>
{{#if userReviews}}
<h2 class="sub-header-regular" id="your-review">{{{__ "your review"}}}</h2>
{{>feed thingFeed=true feedItems=userReviews paginationURL=false}}
{{/if}}
{{#if otherReviews}}
<h2 class="sub-header-regular">{{#if userReviews}}{{{__ "other reviews"}}}{{else}}{{{__ "reviews"}}}{{/if}}</h2>
{{#if user}}
{{#unless userReviews}}
<p><a href="/new/review/{{{thing.urlID}}}" id="add-review" class="pure-button button-rounded"><span class="fa fa-fw fa-pencil spaced-icon">&nbsp;</span>{{{__ "add your review"}}}</a></p>
{{/unless}}
{{else}}
<p><b>{{{__ "sign in to review"}}}</b></p>
{{/if}}
{{>feed thingFeed=true feedItems=otherReviews}}
{{/if}}
</div>
